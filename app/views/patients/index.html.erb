<% content_for(:html_title) { 'Elephant - Gerenciamento Para Psicologia Clínica | Home' } %>

<%= render 'shared/navbar' %>
<%= render 'shared/alerts' %>
<% content_for(:head) do %>
  <meta name="turbolinks-visit-control" content="reload">
<% end %>

<style>
  main {
    height: 100%;
  }
</style>

<%= stylesheet_link_tag 'dataTables.bootstrap4.min', media: 'all', 'data-turbolinks-track': 'reload' %>

<section class="el min-100 d-flex flex-column">
  <h6 class="subtitle light my-3">Clique em um paciente para visualizar/editar.</h6>
  <div class="row m-0 p-0">

    <div class="col-8 col-lg-6 d-flex align-items-center justify-content-center m-0 pl-0">
      <label class="sr-only" for="patient-seach">Pesquisa</label>
      <div class="input-group">
        <div class="input-group-prepend">
          <div class="input-group-text"><i class="fas fa-search"></i></div>
        </div>
        <input type="text" class="form-control" id="patient-search"
          placeholder="busque um nome, estado civil, escolaridade, cargo">
      </div>
    </div>

    <div class="col-4 col-lg-6 d-flex align-items-end justify-content-end m-0 pr-0">
      <%= link_to new_patient_path, class: 'btn btn-outline-primary' do %>
        <i class="d-none d-lg-inline fas fa-plus mr-2"></i>Adicionar
      <% end %>
    </div>
  </div>

  <div class="h-100 py-3">
    <table id="patients-table" class="table table-striped table-bordered table-hover" style="width:100%">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Contato</th>
          <th>Profissão</th>
          <th>Idade</th>
          <th>Gen.</th>
        </tr>
      </thead>
      <tbody>
        <% @patients.each do |patient| %>
          <tr data-link="<%= validation_patients_path(id: patient) %>">
            <td><%= patient.name %></td>
            <td><%= patient.phone || '-' %></td>
            <td><%= patient.profession || '-' %></td>
            <td><%= patient.age %></td>
            <td><%= patient.readable_gender %></td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <script>

    </script>

    <%= javascript_include_tag 'dataTables.min', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'dataTables.bootstrap4.min', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'dataTables.responsive.min', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'patient', 'data-turbolinks-track': 'reload' %>
  </div>
</section